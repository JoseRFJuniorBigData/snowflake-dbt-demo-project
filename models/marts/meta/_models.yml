version: 2


models:
  - name: fct_dbt__model_executions
    meta:
      metrics:
        total_model_runtime:
          type: sum
          sql: ${TABLE}.total_node_runtime
      joins:
        - join: fct_dbt__invocations
          sql_on: ${fct_dbt__model_executions.command_invocation_id} = ${fct_dbt__invocations.command_invocation_id}
        - join: dim_dbt__models
          sql_on: ${dim_dbt__models.model_execution_id} = ${fct_dbt__model_executions.model_execution_id}
  - name: fct_dbt__test_executions
    meta:
      metrics:
        total_test_runtime:
          type: sum
          sql: ${TABLE}.total_node_runtime
      joins:
        - join: fct_dbt__invocations
          sql_on: ${fct_dbt__test_executions.command_invocation_id} = ${fct_dbt__invocations.command_invocation_id}
        - join: dim_dbt__models
          sql_on: ${dim_dbt__tests.test_execution_id} = ${fct_dbt__test_executions.test_execution_id}
